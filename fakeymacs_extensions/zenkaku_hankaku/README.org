#+STARTUP: showall indent

* Fakeymacs extension

** ■ 半角と全角の入力を間違えた際、入力モードの切り替えと入力文字の変換を行う

半角と全角の入力を間違えた際、入力モードの切り替えと入力した文字の変換を一つのキー操作
で行う拡張機能です。

本機能は、Emacs 日本語入力モードを有効にしている場合に利用可能となります。

*** コンフィグレーションパラメータ

|-------------------------+--------------------------------------|
| Configuration parameter | Description                          |
|-------------------------+--------------------------------------|
| fc.zenkaku_hankaku_key  | 本機能を利用するためのキーを指定する |
|-------------------------+--------------------------------------|

*** キーバインド

|---------------------------------+--------------------------------+-----------------|
| Keybind                         | Function                       | Description     |
|---------------------------------+--------------------------------+-----------------|
| fc.zenkaku_hankaku_key の設定値 | zenkaku_henkan/ hankaku_henkan | 初期値：C-Enter |
|---------------------------------+--------------------------------+-----------------|

*** 動作仕様

- 日本語入力中に fc.zenkaku_hankaku_key 変数で指定したキーを押すと、入力した日本語を半角英数字に変換し、IME を OFF にする
- 半角英数字入力中に fc.zenkaku_hankaku_key 変数で指定したキーを押すと、カーソル位置の前にある半角英数字のワードを取り込み、IME を ON にした後、取り込んだ文字のキーを再入力する
- 半角英数字をリージョンで選択しているときに fc.zenkaku_hankaku_key 変数で指定したキーを押すと、選択している半角英数字を取り込み、IME を ON にした後、取り込んだ文字のキーを再入力する

*** 留意事項

● 本機能を Microsoft Word で利用する場合には、次のページの説明に従い、
「段落の選択範囲を自動的に調整する」のチェックを外す設定としてください。
- http://www.dennou.org/word_kaigyokigou/

● 本機能を Microsoft Excel で利用する場合には、セルが編集モードとなっている必要があります。
空のセルをダブルクリックした際や、セルを入力状態にせずに直接文字を入力した場合には、
一見セルは編集モードになっているように見えますが、実際には入力モードというものとなっており、
その状態で本機能を利用すると誤動作してしまいます。セルを編集モードにするには、次の方法が
ありますので、いずれかの方法をご利用ください。
- 空のセルの場合は、セルをトリプルクリック（ダブルクリック＋シングルクリック）する
- 空でないセルの場合は、セルをダブルクリックする（トリプルクリックをしても問題はないようです）
- セルを選択し、F2 を入力する
- edit_mode Extension を利用する（C-Enter キーを共有できるのでお勧めです）
