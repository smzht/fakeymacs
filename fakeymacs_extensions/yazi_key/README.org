#+STARTUP: showall indent

* Fakeymacs extension - yazi_key -

** ■ Yazi 用のキーの設定を行う

Yazi 用のキーの設定を行う拡張機能です。

Yazi は、起動するとターミナルのタイトルを「Yazi: パス名」に置き換える機能をもっているので、
Fakeymacs がターミナルで Yazi を起動したことを検知することができ、Emacs キーバインドに切り替える
ことができます。

 Yazi は次からダウンロードすることができます。

- https://github.com/sxyazi/yazi

*** コンフィグレーションパラメータ

|-------------------------+-----------------------------------------------------------------|
| Configuration parameter | Description                                                     |
|-------------------------+-----------------------------------------------------------------|
| fc.yazi_target          | Yazi 用のキーバインドを利用するアプリケーションソフトを指定する |
|-------------------------+-----------------------------------------------------------------|

*** キーバインド

**** ● 「カーソル移動」のキー設定

|---------+---------------+-------------|
| Keybind | Function      | Description |
|---------+---------------+-------------|
| C-b     | backward_char |             |
| C-f     | forward_char  |             |
| C-p     | previous_line |             |
| C-n     | next_line     |             |
|---------+---------------+-------------|

**** ● 「文字列検索」のキー設定

|---------+------------------+-------------|
| Keybind | Function         | Description |
|---------+------------------+-------------|
| C-r     | isearch_backward |             |
| C-s     | isearch_forward  |             |
|---------+------------------+-------------|

**** ● 「その他」のキー設定

|-----------+---------------+-------------|
| Keybind   | Function      | Description |
|-----------+---------------+-------------|
| C-m       | newline       |             |
| C-g       | keyboard_quit |             |
| Ctl-x C-c | kill_emacs    |             |
|-----------+---------------+-------------|

*** 留意事項

● Ubuntu-24.04 でインストールされる fzf のヴァージョンは 0.44.1 です。yazi はより新しい fzf
のヴァージョンを必要とするようですので、次のサイトの内容に従い、最新の fzf をインストールして
ください。

- https://github.com/junegunn/fzf

#+BEGIN_EXAMPLE
git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf
~/.fzf/install
#+END_EXAMPLE

bash を利用している場合は ~/.fzf.bash というファイルが作成されます。既にインストールされている
fzf よりコマンドのサーチパスを上位にする必要があるため、~/.fzf.bash の中の PATH の設定を次のように
変更してください。

#+BEGIN_EXAMPLE
  # PATH="${PATH:+${PATH}:}/home/<user>/.fzf/bin"
  PATH="/home/<user>/.fzf/bin${PATH:+:${PATH}}"
#+END_EXAMPLE

※ <user> の箇所は、各自の設定に置き換えてください。

また、~/.fzf.bash は .bashrc から実行されるように設定が追加されますが、~/.fzf.bash の内部で
bind コマンドが実行されるため、Emacs の shell-mode を起動した際にエラーメッセージが表示されます。
このため、Emacs をご利用の場合は、.bashrc の最終行に追加された行を次のように変更してください。

#+BEGIN_EXAMPLE
if [[[[ ! "$INSIDE_EMACS" =~ comint ]]]]; then
    [ -f ~/.fzf.bash ] && source ~/.fzf.bash
fi
#+END_EXAMPLE

動作の確認は、shell、yazi を再起動し、Z を押下してみてください。

● 本フォルダにある _config_personal.py を config_personal.py というファイル名にすることで
機能拡張ファイルとして機能します。yazi_key Extension の機能を拡張する際にご利用ください。
